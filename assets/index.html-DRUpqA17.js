import{_ as i,c as a,b as n,o as e}from"./app-D3v_Ax5S.js";const l={};function t(h,s){return e(),a("div",null,s[0]||(s[0]=[n(`<h2 id="_1-docker-基本概念" tabindex="-1"><a class="header-anchor" href="#_1-docker-基本概念"><span>1. Docker 基本概念</span></a></h2><h3 id="_1-1-什么是-docker" tabindex="-1"><a class="header-anchor" href="#_1-1-什么是-docker"><span>1.1 什么是 Docker</span></a></h3><p>Docker 是一个开源的容器化平台，它允许开发者将应用程序及其依赖打包到一个可移植的容器中，然后在任何地方运行。Docker 容器是轻量级的、独立的运行环境，可以在不同的操作系统上运行。</p><h3 id="_1-2-docker-的组成部分" tabindex="-1"><a class="header-anchor" href="#_1-2-docker-的组成部分"><span>1.2 Docker 的组成部分</span></a></h3><ul><li><strong>Docker 引擎</strong>：Docker 引擎是 Docker 的核心组件，负责构建、运行和管理容器。它包括 Docker 守护进程（dockerd）和 Docker 客户端（docker）。</li><li><strong>Docker 镜像</strong>：Docker 镜像是一个只读的模板，包含了运行应用程序所需的所有文件和依赖。镜像可以看作是应用程序的静态版本。</li><li><strong>Docker 容器</strong>：Docker 容器是镜像的运行实例。容器是动态的，可以启动、停止和删除。每个容器都是隔离的，拥有自己的文件系统、网络和进程空间。</li><li><strong>Docker 仓库</strong>：Docker 仓库是一个存储和分发 Docker 镜像的平台。Docker Hub 是最著名的公共仓库，用户可以在其中存储和共享镜像。</li></ul><h3 id="_1-3-docker-的优点" tabindex="-1"><a class="header-anchor" href="#_1-3-docker-的优点"><span>1.3 Docker 的优点</span></a></h3><ul><li><strong>轻量级</strong>：容器比虚拟机更轻量级，启动和停止速度更快。</li><li><strong>可移植性</strong>：容器可以在任何地方运行，包括开发环境、测试环境和生产环境。</li><li><strong>隔离性</strong>：容器之间相互隔离，安全性更高。</li><li><strong>资源利用率高</strong>：容器共享主机操作系统，资源利用率更高。</li></ul><h2 id="_2-docker-安装与配置" tabindex="-1"><a class="header-anchor" href="#_2-docker-安装与配置"><span>2. Docker 安装与配置</span></a></h2><h3 id="_2-1-安装-docker" tabindex="-1"><a class="header-anchor" href="#_2-1-安装-docker"><span>2.1 安装 Docker</span></a></h3><p>Docker 的安装和配置因操作系统而异。以下是一些常见操作系统的安装步骤：</p><h4 id="_2-1-1-在-ubuntu-上安装-docker" tabindex="-1"><a class="header-anchor" href="#_2-1-1-在-ubuntu-上安装-docker"><span>2.1.1 在 Ubuntu 上安装 Docker</span></a></h4><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apt-get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> update</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apt-get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> docker.io</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-1-2-在-centos-上安装-docker" tabindex="-1"><a class="header-anchor" href="#_2-1-2-在-centos-上安装-docker"><span>2.1.2 在 CentOS 上安装 Docker</span></a></h4><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> yum</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> docker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-1-3-在-windows-上安装-docker" tabindex="-1"><a class="header-anchor" href="#_2-1-3-在-windows-上安装-docker"><span>2.1.3 在 Windows 上安装 Docker</span></a></h4><p>Docker 桌面版在 Windows 和 macOS 上提供了图形界面，方便用户管理和使用 Docker。</p><h4 id="_2-1-4-在-macos-上安装-docker" tabindex="-1"><a class="header-anchor" href="#_2-1-4-在-macos-上安装-docker"><span>2.1.4 在 macOS 上安装 Docker</span></a></h4><p>Docker Desktop 在 macOS 上提供了图形界面，方便用户管理和使用 Docker。</p><h2 id="_3-什么是镜像" tabindex="-1"><a class="header-anchor" href="#_3-什么是镜像"><span>3. 什么是镜像</span></a></h2><p>镜像是一个只读的模板，包含了运行应用程序所需的所有文件和依赖。镜像可以看作是应用程序的静态版本。</p><h2 id="_4-什么是容器" tabindex="-1"><a class="header-anchor" href="#_4-什么是容器"><span>4. 什么是容器</span></a></h2><p>容器是镜像的运行实例。容器是动态的，可以启动、停止和删除。每个容器都是隔离的，拥有自己的文件系统、网络和进程空间。 容器可以理解成一个linux的虚拟机，但是比虚拟机更轻量级, 更节省资源,是因为有些linux的命令在容器中被阉割了。 容器运行是依赖镜像的，容器的大小等于镜像的大小加上容器运行时所产生的数据，例如java项目运行时产生的日志、临时文件等。</p><h2 id="_5-镜像有关操作" tabindex="-1"><a class="header-anchor" href="#_5-镜像有关操作"><span>5. 镜像有关操作</span></a></h2><h3 id="_5-1-检索镜像" tabindex="-1"><a class="header-anchor" href="#_5-1-检索镜像"><span>5.1 检索镜像</span></a></h3><p>docker search 镜像名称</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> search</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mysql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_search.webp" alt="docker search"><p>也可以去docker hub官网查看镜像信息</p><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_search_hub.webp" alt="docker search hub"><h3 id="_5-2-拉取镜像" tabindex="-1"><a class="header-anchor" href="#_5-2-拉取镜像"><span>5.2 拉取镜像</span></a></h3><p>docker pull 镜像名称[:tag], tag是镜像的版本, 不加版本号默认是latest</p><p>docker下载镜像，需要查看镜像的架构，例如mysql:lts-oracle, macos架构是arm64, 所以需要下载mysql:lts-oracle-arm64</p><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_pull_arm64.webp" alt="docker pull arm64" style="zoom:50%;"><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pull</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mysql:lts-oracle</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_pull.webp" alt="docker pull" style="zoom:50%;"><h4 id="_5-2-1-docker-镜像拉取机制" tabindex="-1"><a class="header-anchor" href="#_5-2-1-docker-镜像拉取机制"><span>5.2.1 Docker 镜像拉取机制</span></a></h4><ol><li><strong>镜像地址格式</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">仓库地址:端口</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">命名空间</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">镜像名</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">标签</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li><strong>不同格式示例</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 从 Docker Hub 拉取（默认）</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pull</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx:latest</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 完整形式是：docker.io/library/nginx:latest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 从私有仓库拉取</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pull</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 192.168.1.100:5000/nginx:latest</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 指定了完整的仓库地址和端口</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 从其他公共仓库拉取</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pull</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> registry.cn-hangzhou.aliyuncs.com/namespace/nginx:latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>Docker 镜像拉取顺序</strong></li></ol><ul><li>检查地址是否包含仓库地址</li><li>有：直接从指定地址拉取（如 192.168.1.100:5000）</li><li>没有：从默认仓库（Docker Hub）拉取</li></ul><ol start="4"><li><strong>示例说明</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 这个会从私有仓库拉取，因为指定了完整地址</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pull</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 192.168.1.100:5000/nginx:latest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 这个会从 Docker Hub 拉取，因为没有指定仓库地址</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pull</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx:latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-查看镜像" tabindex="-1"><a class="header-anchor" href="#_5-3-查看镜像"><span>5.3 查看镜像</span></a></h3><p>docker images [option]</p><blockquote><p>option: -a: 显示所有镜像</p><p>-q: 只显示镜像ID</p></blockquote><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> images</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_images.webp" alt="docker images" style="zoom:50%;"><h3 id="_5-4-docker-images-输出详解" tabindex="-1"><a class="header-anchor" href="#_5-4-docker-images-输出详解"><span>5.4 Docker Images 输出详解</span></a></h3><ol><li><strong>docker images 命令输出格式</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">REPOSITORY</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                          TAG</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">       IMAGE</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ID</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">          CREATED</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">         SIZE</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                              latest</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    abc123...</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">         2</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> hours</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ago</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">     142MB</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">192.168.1.100:5000/nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">           latest</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    abc123...</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">         2</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> hours</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ago</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">     142MB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>REPOSITORY 列说明</strong></li></ol><ul><li>REPOSITORY 表示镜像的存储位置和命名空间</li><li>格式为：[仓库地址]/[命名空间]/[镜像名]</li><li>例如： <ul><li><code>nginx</code> → Docker Hub 官方镜像</li><li><code>192.168.1.100:5000/nginx</code> → 私有仓库镜像</li><li><code>username/nginx</code> → Docker Hub 个人仓库镜像</li><li><code>registry.company.com/project/nginx</code> → 企业私有仓库镜像</li></ul></li></ul><ol start="3"><li><strong>常见的 REPOSITORY 格式</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Docker Hub 官方镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">REPOSITORY</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mysql</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ubuntu</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Docker Hub 个人仓库镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">REPOSITORY</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">username/my-nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">company/custom-nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 私有仓库镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">REPOSITORY</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">192.168.1.100:5000/nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">registry.company.com/project/nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li><strong>REPOSITORY 的作用</strong></li></ol><ul><li>标识镜像的来源</li><li>指定推送的目标位置</li><li>区分不同的镜像版本</li><li>管理镜像的命名空间</li></ul><h3 id="_5-5-docker-镜像标识规则" tabindex="-1"><a class="header-anchor" href="#_5-5-docker-镜像标识规则"><span>5.5 Docker 镜像标识规则</span></a></h3><p>镜像标识规则是镜像的唯一标识，由镜像ID、仓库地址、命名空间、镜像名和标签组成。</p><ol><li><strong>完整格式</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">仓库地址</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">命名空间</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">镜像名</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">标签</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 例如：</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker.io/library/nginx:latest</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">      # Docker Hub 官方镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker.io/username/nginx:latest</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     # Docker Hub 用户镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">192.168.1.100:5000/nginx:latest</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 私有仓库镜像</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>简写规则</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Docker Hub 官方镜像可以简写</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nginx:latest</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                    # 等同于 docker.io/library/nginx:latest</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mysql:8.0</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                      # 等同于 docker.io/library/mysql:8.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 其他仓库必须写完整地址</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">username/nginx:latest</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">          # Docker Hub 用户镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">192.168.1.100:5000/nginx:v1</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">   # 私有仓库镜像</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>镜像标识组成部分</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 完整示例解析：</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">registry.company.com:5000/project/nginx:v1.0</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">仓库地址</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">命名空间</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">镜像名</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">标签</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Docker Hub 官方镜像解析：</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nginx:latest</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">镜像名</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">标签</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 默认补充：docker.io/library/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li><strong>不同类型镜像示例</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Docker Hub 官方镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nginx:latest</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mysql:8.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Docker Hub 用户镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">username/my-app:1.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 私有仓库镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">192.168.1.100:5000/nginx:latest</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">registry.company.com/project/app:v1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-6-删除镜像" tabindex="-1"><a class="header-anchor" href="#_5-6-删除镜像"><span>5.6 删除镜像</span></a></h3><p>docker rmi [option] image:tag</p><blockquote><p>option:</p><p>-f: 强制删除, 即使镜像正在使用</p><p>docker rmi -f <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>d</mi><mi>o</mi><mi>c</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>g</mi><mi>e</mi><mi>s</mi><mo>−</mo><mi>a</mi><mi>q</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">(docker images -aq),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">oc</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">ima</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">es</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span>(docker images -aq) 即取得所有镜像ID集合, 然后强制删除</p></blockquote><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rmi</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mysql:lts-oracle</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_rmi_tag.webp" alt="docker rmi tag" style="zoom:50%;"><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rmi</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 镜像id</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_rmi_id.webp" alt="docker rmi id" style="zoom:50%;"><h2 id="_6-容器有关操作" tabindex="-1"><a class="header-anchor" href="#_6-容器有关操作"><span>6. 容器有关操作</span></a></h2><h3 id="_6-1-创建容器" tabindex="-1"><a class="header-anchor" href="#_6-1-创建容器"><span>6.1 创建容器</span></a></h3><p>docker run [option] image:tag</p><blockquote><p>option:</p><p>-d: 后台运行容器,并返回容器ID</p><p>-p: 指定端口映射, 格式为: 宿主机端口:容器端口</p><p>-v: 挂载卷, 格式为: 宿主机路径:容器路径, 例如: -v /mydata/mysql/data:/var/lib/mysql</p><p>--name: 指定容器名称</p></blockquote><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> run</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -d</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -p</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 81:80</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_run.webp" alt="docker run" style="zoom:50%;"><p>curl localhost:81</p><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_curl_nginx.webp" alt="docker run curl" style="zoom:50%;"><h4 id="_6-1-1-挂载卷的位置" tabindex="-1"><a class="header-anchor" href="#_6-1-1-挂载卷的位置"><span>6.1.1 挂载卷的位置</span></a></h4><p>挂载卷容器的位置一般需要在dockerhub中查看，例如nginx的挂载卷位置是/usr/share/nginx/html</p><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_nginx_volume.webp" alt="docker nginx volume" style="zoom:50%;"><p>图中指定了静态文件在容器的位置,以及如何自定义配置</p><h4 id="_6-1-2-环境变量的配置" tabindex="-1"><a class="header-anchor" href="#_6-1-2-环境变量的配置"><span>6.1.2 环境变量的配置</span></a></h4><p>例如 mysql的环境变量，可以指定mysql的root密码，创建用户，创建数据库等</p><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_mysql_env.webp" alt="docker mysql env" style="zoom:50%;"><h3 id="_6-2-查看容器" tabindex="-1"><a class="header-anchor" href="#_6-2-查看容器"><span>6.2 查看容器</span></a></h3><p>docker ps [option] 默认是查看正在运行的容器</p><blockquote><p>option:</p><p>-a: 显示所有容器 (包括已经停止的)</p><p>-q: 只显示容器ID</p></blockquote><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ps</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_ps.webp" alt="docker ps" style="zoom:50%;"><h3 id="_6-3-查看容器的状态" tabindex="-1"><a class="header-anchor" href="#_6-3-查看容器的状态"><span>6.3 查看容器的状态</span></a></h3><p>docker stats container_name</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> stats</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_stats.webp" alt="docker stats" style="zoom:50%;"><p>包含cpu、内存、网络、io等信息，内存限制是容器最大可用内存，内存使用是容器实际使用的内存，内存使用率是容器实际使用的内存占内存限制的百分比。</p><h3 id="_6-4-查看容器日志" tabindex="-1"><a class="header-anchor" href="#_6-4-查看容器日志"><span>6.4 查看容器日志</span></a></h3><p>docker logs [option] container_name</p><blockquote><p>option:</p><p>-f: 跟随日志输出</p><p>-t: 显示日志时间</p><p>-tail: 显示日志条数 --tail 10 显示最后10条日志</p></blockquote><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> logs</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -f</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_logs.webp" alt="docker logs" style="zoom:50%;"><h3 id="_6-5-查看容器进程信息" tabindex="-1"><a class="header-anchor" href="#_6-5-查看容器进程信息"><span>6.5 查看容器进程信息</span></a></h3><p>docker top container_name</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> top</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_top.webp" alt="docker top" style="zoom:50%;"><h3 id="_6-6-查看容器详细信息" tabindex="-1"><a class="header-anchor" href="#_6-6-查看容器详细信息"><span>6.6 查看容器详细信息</span></a></h3><p>docker inspect container_name 包含容器ID、镜像、创建时间、状态、端口、网络、挂载卷、命令、状态、状态码、退出码、重启次数等信息</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> inspect</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_inspect.webp" alt="docker inspect" style="zoom:50%;"><h3 id="_6-7-进入容器" tabindex="-1"><a class="header-anchor" href="#_6-7-进入容器"><span>6.7 进入容器</span></a></h3><p>docker exec -it container_name /bin/bash 容器内就是linux系统，可以执行linux命令</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> exec</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -it</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /bin/bash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_exec.webp" alt="docker exec" style="zoom:50%;"><p>exit 退出容器</p><h3 id="_6-8-停止容器" tabindex="-1"><a class="header-anchor" href="#_6-8-停止容器"><span>6.8 停止容器</span></a></h3><p>docker stop container_name</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> stop</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_stop.webp" alt="docker stop" style="zoom:50%;"><h3 id="_6-9-启动容器" tabindex="-1"><a class="header-anchor" href="#_6-9-启动容器"><span>6.9 启动容器</span></a></h3><p>docker start container_name</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> start</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_start.webp" alt="docker start" style="zoom:50%;"><h3 id="_6-10-重启容器" tabindex="-1"><a class="header-anchor" href="#_6-10-重启容器"><span>6.10 重启容器</span></a></h3><p>docker restart container_name</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_restart.webp" alt="docker restart" style="zoom:50%;"><h3 id="_6-11-删除容器" tabindex="-1"><a class="header-anchor" href="#_6-11-删除容器"><span>6.11 删除容器</span></a></h3><p>docker rm container_name</p><blockquote><p>option:<br> -f: 强制删除, 即使容器正在使用 docker rm -f <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>d</mi><mi>o</mi><mi>c</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi>p</mi><mi>s</mi><mo>−</mo><mi>a</mi><mi>q</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">(docker ps -aq),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">oc</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">p</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span>(docker ps -aq) 即取得所有容器ID集合, 然后强制删除</p></blockquote><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><img src="https://netjic.github.io/picx-images-hosting/dockerimage/docker_rm.webp" alt="docker rm" style="zoom:50%;"><h3 id="_6-12-复制文件到容器" tabindex="-1"><a class="header-anchor" href="#_6-12-复制文件到容器"><span>6.12 复制文件到容器</span></a></h3><p>docker cp 宿主机文件路径 容器ID:容器路径</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /Users/jichuang/docker/nginx.conf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx:/etc/nginx/nginx.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_6-13-复制文件到宿主机" tabindex="-1"><a class="header-anchor" href="#_6-13-复制文件到宿主机"><span>6.13 复制文件到宿主机</span></a></h3><p>docker cp 容器ID:容器路径 宿主机路径</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx:/etc/nginx/nginx.conf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /Users/jichuang/docker/nginx.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_6-14-镜像保存" tabindex="-1"><a class="header-anchor" href="#_6-14-镜像保存"><span>6.14 镜像保存</span></a></h3><p>docker save -o 镜像名称.tar 镜像名称:tag</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 将镜像保存为tar文件</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> save</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -o</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx.tar</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx:latest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 也可以使用重定向方式保存</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> save</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx:latest</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx.tar</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-15-镜像加载" tabindex="-1"><a class="header-anchor" href="#_6-15-镜像加载"><span>6.15 镜像加载</span></a></h3><p>docker load -i 镜像名称.tar</p><blockquote><p>option: -i: 从文件输入 -q: 静默模式，不输出详细信息</p></blockquote><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 从文件加载镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> load</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -i</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx.tar</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 也可以使用重定向方式加载</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> load</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx.tar</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-16-镜像导入-不同架构" tabindex="-1"><a class="header-anchor" href="#_6-16-镜像导入-不同架构"><span>6.16 镜像导入（不同架构）</span></a></h3><p>CPU 架构的差异，导致不同系统之间无法直接导入镜像，例如macos的arm64架构导出的镜像直接导入linux的x86架构是不能使用的，需要使用中间系统进行转换</p><p>例如macos的arm64架构的镜像，需要导入到linux的x86架构的容器中，可以使用qemu-user-static进行转换</p><h3 id="_6-17-docker-push-机制" tabindex="-1"><a class="header-anchor" href="#_6-17-docker-push-机制"><span>6.17 Docker Push 机制</span></a></h3><ol><li><strong>Push 命令格式</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> push</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [仓库地址:端口]/</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">镜像名</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">标签</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li><strong>完整推送流程示例</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 1. 假设我们有一个本地 nginx 镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> images</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">REPOSITORY</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    TAG</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">      IMAGE</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ID</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">         latest</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   abc123...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 2. 给镜像打标签，指向目标仓库 根据 nginx:latest 镜像创建一个新的标签，指向目标仓库    </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tag</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx:latest</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 192.168.1.100:5000/nginx:latest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 使用 tag 命令后</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> images</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">REPOSITORY</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                          TAG</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">      IMAGE</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ID</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">                              latest</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   abc123...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">192.168.1.100:5000/nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">          latest</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   abc123...</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 新增了一个标签，指向同一个镜像</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 3. 推送到私有仓库 push 私有仓库地址/镜像名:标签</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> push</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 192.168.1.100:5000/nginx:latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><strong>Push 过程发生了什么</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 推送过程输出示例</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">The</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> push</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> refers</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> repository</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [192.168.1.100:5000/nginx]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">a2e59b4c8e77:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Pushing</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [==&gt;                                                </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">]</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 12.8MB/120MB</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">d874fd2bc83b:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Pushed</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">32ce5f6a5106:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Pushing</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [====&gt;                                              </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">]</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 15.2MB/140MB</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">f1db227348d0:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Waiting</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">b8d6e692a25e:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Pushed</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">e379e8aedd4d:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Layer</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> already</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> exists</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>分层推送：Docker 镜像是分层的，每层单独推送</li><li>增量推送：如果某层已存在于目标仓库，则跳过</li><li>并行推送：多个层可以并行推送</li></ul><ol start="4"><li><strong>常见错误处理</strong></li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 推送被拒绝</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Error</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> response</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> from</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> daemon:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> unauthorized:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> authentication</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> required</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 解决方法：先登录</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> login</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 192.168.1.100:5000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 连接被拒绝</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Error</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> response</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> from</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> daemon:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Get</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://192.168.1.100:5000/v2/</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> server</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gave</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HTTP</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> response</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HTTPS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> client</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 解决方法：配置 insecure-registry</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  &quot;insecure-registries&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">192.168.1.100:5000</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">]</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-18-从内网服务器下载镜像" tabindex="-1"><a class="header-anchor" href="#_6-18-从内网服务器下载镜像"><span>6.18 从内网服务器下载镜像</span></a></h3><h4 id="_6-18-1-配置内网镜像仓库" tabindex="-1"><a class="header-anchor" href="#_6-18-1-配置内网镜像仓库"><span>6.18.1 配置内网镜像仓库</span></a></h4><p>Docker Registry 是一个用于存储和分发 Docker 镜像的服务器应用程序：</p><ul><li>默认运行在 5000 端口</li><li>可以作为私有镜像仓库使用</li><li>Docker Hub 就是一个公共的 Registry 服务</li></ul><h4 id="_6-18-2-部署-registry-服务" tabindex="-1"><a class="header-anchor" href="#_6-18-2-部署-registry-服务"><span>6.18.2 部署 Registry 服务</span></a></h4><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 最简单的部署方式</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> run</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -d</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  -p</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 5000:5000</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  --restart=always</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  --name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> registry</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  registry:2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 带基础认证的部署</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> run</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -d</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  -p</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 5000:5000</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  --restart=always</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  --name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> registry</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  -v</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /auth:/auth</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  -e</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">REGISTRY_AUTH=htpasswd</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  -e</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  -e</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  registry:2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 创建用户认证文件</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> run</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --entrypoint</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> htpasswd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> registry:2</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -Bbn</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> username</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> password</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /auth/htpasswd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-18-3-使用私有-registry" tabindex="-1"><a class="header-anchor" href="#_6-18-3-使用私有-registry"><span>6.18.3 使用私有 Registry</span></a></h4><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 登录私有仓库（如果配置了认证）</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> login</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 192.168.1.100:5000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 推送镜像到私有仓库</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> tag</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx:latest</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 192.168.1.100:5000/nginx:latest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 这个命令的含义是：</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># - 为现有的 \`nginx:latest\` 镜像创建一个新的标签</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># - 新标签格式为：\`仓库地址/镜像名:标签\`</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># - 相当于给镜像取了一个新名字，指向同一个镜像</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># - 原镜像和新标签的镜像 ID 是相同的</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> push</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 192.168.1.100:5000/nginx:latest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 这个命令的含义是：</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># - 将已标记的镜像推送到指定的镜像仓库</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># - \`192.168.1.100:5000\` 是目标仓库地址</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># - 推送后，其他机器就可以从这个仓库拉取镜像</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 从私有仓库拉取镜像</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pull</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 192.168.1.100:5000/nginx:latest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 查看仓库中的镜像列表</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://192.168.1.100:5000/v2/_catalog</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 查看特定镜像的标签列表</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://192.168.1.100:5000/v2/nginx/tags/list</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-18-4-registry-配置说明" tabindex="-1"><a class="header-anchor" href="#_6-18-4-registry-配置说明"><span>6.18.4 Registry 配置说明</span></a></h4><ul><li>默认存储位置：/var/lib/registry</li><li>支持多种存储后端：本地文件系统、S3、Azure、阿里云OSS等</li><li>支持 TLS 证书配置</li><li>支持访问控制和认证</li><li>支持镜像删除功能（需要配置）</li></ul><h4 id="_6-18-5-注意事项" tabindex="-1"><a class="header-anchor" href="#_6-18-5-注意事项"><span>6.18.5 注意事项</span></a></h4><ul><li>生产环境建议配置 HTTPS</li><li>建议配置访问认证</li><li>注意存储空间管理</li><li>考虑备份机制</li><li>建议配置镜像清理策略</li></ul>`,173)]))}const d=i(l,[["render",t],["__file","index.html.vue"]]),r=JSON.parse('{"path":"/article/3yw78lpd/","title":"Docker的使用","lang":"zh-CN","frontmatter":{"title":"Docker的使用","createTime":"2024/12/30 20:07:30","tags":["docker"],"permalink":"/article/3yw78lpd/"},"headers":[],"readingTime":{"minutes":11.45,"words":3435},"git":{"updatedTime":1735723707000,"contributors":[{"name":"netjic","username":"netjic","email":"netjic@163.com","commits":1,"avatar":"https://gravatar.com/avatar/374578fe375437866193fe849b770e3f9c74eacc1a7125303870c05b7a97309d?d=retro"}]},"filePathRelative":"docker/docker.md","categoryList":[{"id":"05b605","sort":10008,"name":"docker"}],"bulletin":false}');export{d as comp,r as data};
